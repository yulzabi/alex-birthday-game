<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ğŸ§© ××©×—×§ ×–×™×›×¨×•×Ÿ - ××œ×›×¡ ×‘×ª 5!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #06D6A0, #11998e, #38ef7d);
            background-size: 400% 400%;
            animation: gradientShift 6s ease infinite;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0%   { background-position: 0% 50%; }
            50%  { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* ===== ×›×¤×ª×•×¨ ×—×–×¨×” ===== */
        .back-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 3000;
            background: rgba(255, 255, 255, 0.85);
            color: #333;
            text-decoration: none;
            padding: 8px 18px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 700;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
            transition: transform 0.2s;
        }

        .back-btn:hover, .back-btn:active {
            transform: scale(1.05);
        }

        /* ===== ×›×•×ª×¨×ª ===== */
        .header {
            text-align: center;
            padding: 15px 20px 5px;
        }

        .header h1 {
            font-size: clamp(1.5rem, 6vw, 2.5rem);
            color: #fff;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.3);
        }

        /* ===== HUD ===== */
        .hud {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 8px;
            font-size: clamp(1rem, 3.5vw, 1.4rem);
            color: #fff;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
            font-weight: 700;
        }

        /* ===== ×œ×•×— ×§×œ×¤×™× ===== */
        .board {
            display: grid;
            gap: 10px;
            max-width: 500px;
            margin: 10px auto;
            padding: 0 15px;
            perspective: 800px;
        }

        .board.level-1 { grid-template-columns: repeat(4, 1fr); }
        .board.level-2 { grid-template-columns: repeat(4, 1fr); }
        .board.level-3 { grid-template-columns: repeat(4, 1fr); }

        /* ===== ×§×œ×£ ===== */
        .card {
            aspect-ratio: 1;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card.matched {
            transform: rotateY(180deg);
            animation: matchPop 0.5s ease;
        }

        @keyframes matchPop {
            0%   { transform: rotateY(180deg) scale(1); }
            50%  { transform: rotateY(180deg) scale(1.15); }
            100% { transform: rotateY(180deg) scale(1); }
        }

        .card-face {
            position: absolute;
            inset: 0;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            backface-visibility: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .card-front {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            font-size: clamp(2rem, 8vw, 3rem);
            transform: rotateY(180deg);
        }

        .card-back {
            background: linear-gradient(135deg, #FF6FB7, #FF8DC7);
            font-size: clamp(2rem, 8vw, 3rem);
            border: 3px solid rgba(255,255,255,0.5);
        }

        .card.matched .card-front {
            background: linear-gradient(135deg, #06D6A0, #38ef7d);
            border: 3px solid #fff;
        }

        /* ===== ××¡×š ×¤×ª×™×—×” ===== */
        #intro-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #06D6A0, #11998e, #38ef7d);
            background-size: 400% 400%;
            animation: gradientShift 4s ease infinite;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
        }

        #intro-screen .t1 {
            font-size: clamp(2rem, 8vw, 4rem);
            color: #fff;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            animation: bounceIn 0.8s ease;
        }

        #intro-screen .t2 {
            font-size: clamp(3rem, 12vw, 6rem);
            margin: 10px 0;
            animation: bounceIn 0.8s ease 0.2s both;
        }

        #intro-screen .t3 {
            font-size: clamp(1.2rem, 4vw, 2rem);
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: bounceIn 0.8s ease 0.4s both;
        }

        #intro-screen .play-btn {
            font-size: clamp(1.2rem, 4vw, 2rem);
            color: #fff;
            margin-top: 40px;
            animation: pulse 1.5s infinite, bounceIn 0.8s ease 0.6s both;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 40px;
            border-radius: 50px;
            border: 3px solid rgba(255, 255, 255, 0.5);
        }

        @keyframes bounceIn {
            0%   { transform: scale(0); opacity: 0; }
            60%  { transform: scale(1.15); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50%      { transform: scale(1.05); opacity: 0.8; }
        }

        /* ===== ××¡×š × ×™×¦×—×•×Ÿ ===== */
        #win-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #FFD700, #FFA500, #FF6FB7);
            background-size: 400% 400%;
            animation: gradientShift 3s ease infinite;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            cursor: pointer;
        }

        #win-screen .t1 {
            font-size: clamp(2rem, 8vw, 4rem);
            color: #fff;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            animation: bounceIn 0.8s ease;
        }

        #win-screen .t2 {
            font-size: clamp(3rem, 12vw, 6rem);
            animation: bounceIn 0.8s ease 0.2s both;
        }

        #win-screen .t3 {
            font-size: clamp(1.2rem, 4vw, 2rem);
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: bounceIn 0.8s ease 0.4s both;
        }

        #win-screen .play-btn {
            font-size: clamp(1.2rem, 4vw, 2rem);
            color: #fff;
            margin-top: 40px;
            animation: pulse 1.5s infinite, bounceIn 0.8s ease 0.6s both;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 40px;
            border-radius: 50px;
            border: 3px solid rgba(255, 255, 255, 0.5);
        }

        /* ===== ×”×•×“×¢×ª ×¢×™×“×•×“ ===== */
        #encourage {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: clamp(2rem, 8vw, 4rem);
            color: #FFD700;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            z-index: 600;
            pointer-events: none;
        }

        #encourage.show {
            animation: encouragePop 1.5s ease forwards;
        }

        @keyframes encouragePop {
            0%   { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            20%  { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
            80%  { opacity: 1; }
            100% { transform: translate(-50%, -60%) scale(0.8); opacity: 0; }
        }

        /* ===== ×”×•×“×¢×ª ×©×œ×‘ ===== */
        #level-msg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: clamp(2rem, 8vw, 3.5rem);
            color: #fff;
            text-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            z-index: 700;
            pointer-events: none;
            background: rgba(6, 214, 160, 0.9);
            padding: 20px 40px;
            border-radius: 25px;
        }

        #level-msg.show {
            animation: encouragePop 2s ease forwards;
        }

        /* ===== ×§×•× ×¤×˜×™ ===== */
        .cf {
            position: fixed;
            border-radius: 2px;
            animation: confettiFall linear infinite;
            z-index: 1999;
            pointer-events: none;
        }

        @keyframes confettiFall {
            0%   { transform: translateY(-10vh) rotate(0); opacity: 1; }
            100% { transform: translateY(110vh) rotate(720deg); opacity: 0.7; }
        }
    </style>
</head>
<body>

    <a href="../../index.html" class="back-btn">ğŸ  ×—×–×¨×” ×œ×ª×¤×¨×™×˜</a>

    <!-- ××¡×š ×¤×ª×™×—×” -->
    <div id="intro-screen">
        <div class="t1">ğŸ§© ××©×—×§ ×–×™×›×¨×•×Ÿ ğŸ§©</div>
        <div class="t2">ğŸƒğŸƒ</div>
        <div class="t3">××¦××™ ××ª ×›×œ ×”×–×•×’×•×ª!</div>
        <div class="play-btn">ğŸ‘† ×œ×—×¦×™ ×›×“×™ ×œ×©×—×§! ğŸ‘†</div>
    </div>

    <!-- ××¡×š × ×™×¦×—×•×Ÿ -->
    <div id="win-screen">
        <div class="t1">ğŸ‰ ×›×œ ×”×›×‘×•×“ ××œ×›×¡! ğŸ‰</div>
        <div class="t2">ğŸ†ğŸ‘‘ğŸŒŸ</div>
        <div class="t3">×–×™×›×¨×•×Ÿ ××“×”×™×! ğŸ§ ğŸ’–</div>
        <div class="play-btn">ğŸ‘† ×©×•×‘! ğŸ‘†</div>
    </div>

    <!-- ×”×•×“×¢×ª ×¢×™×“×•×“ -->
    <div id="encourage"></div>
    <div id="level-msg"></div>

    <!-- ×”××©×—×§ -->
    <div id="game-area" style="display:none;">
        <div class="header">
            <h1>ğŸ§© ××©×—×§ ×–×™×›×¨×•×Ÿ ğŸ§©</h1>
        </div>
        <div class="hud">
            <span>â­ ×–×•×’×•×ª: <span id="pairs-found">0</span>/<span id="pairs-total">4</span></span>
            <span>ğŸ ×©×œ×‘: <span id="level">1</span>/3</span>
        </div>
        <div class="board" id="board"></div>
    </div>

    <script>
    (function() {
        "use strict";

        var EMOJIS = ['ğŸ‚', 'ğŸ¦‹', 'ğŸ‘‘', 'ğŸŒˆ', 'ğŸ’–', 'â­', 'ğŸ', 'ğŸ­', 'ğŸ§', 'ğŸˆ', 'ğŸ¦„', 'ğŸŒ¸'];
        var LEVELS = [
            { pairs: 4, cols: 4 },  // ×©×œ×‘ 1: 8 ×§×œ×¤×™× (4x2)
            { pairs: 6, cols: 4 },  // ×©×œ×‘ 2: 12 ×§×œ×¤×™× (4x3) 
            { pairs: 8, cols: 4 },  // ×©×œ×‘ 3: 16 ×§×œ×¤×™× (4x4)
        ];
        var ENCOURAGEMENTS = ['!×›×œ ×”×›×‘×•×“ ğŸŒŸ', '!××“×”×™× ğŸ‰', '!×›×•×›×‘×ª âœ¨', '!×™×•×¤×™ ğŸ’–', '!×¡×—×˜×™×™×Ÿ ğŸ†', '!××œ×›×” ğŸ‘‘'];
        var COLORS = ['#FF6FB7', '#FFD166', '#06D6A0', '#118AB2', '#EF476F', '#FFD700'];

        var audioCtx = null;
        var currentLevel = 0;
        var pairsFound = 0;
        var flippedCards = [];
        var lockBoard = false;
        var lastEncTime = 0;

        var introScreen = document.getElementById('intro-screen');
        var winScreen = document.getElementById('win-screen');
        var gameArea = document.getElementById('game-area');
        var board = document.getElementById('board');
        var pairsFoundEl = document.getElementById('pairs-found');
        var pairsTotalEl = document.getElementById('pairs-total');
        var levelEl = document.getElementById('level');

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(type) {
            if (!audioCtx) return;
            var now = audioCtx.currentTime;
            var osc = audioCtx.createOscillator();
            var gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            if (type === 'flip') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, now);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.15);
                osc.start(now);
                osc.stop(now + 0.15);
            } else if (type === 'match') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523, now);
                osc.frequency.setValueAtTime(659, now + 0.1);
                osc.frequency.setValueAtTime(784, now + 0.2);
                gain.gain.setValueAtTime(0.15, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.35);
                osc.start(now);
                osc.stop(now + 0.35);
            } else if (type === 'wrong') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(300, now);
                osc.frequency.setValueAtTime(250, now + 0.1);
                gain.gain.setValueAtTime(0.08, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.2);
                osc.start(now);
                osc.stop(now + 0.2);
            } else if (type === 'levelup') {
                var notes = [523, 659, 784, 1047];
                notes.forEach(function(freq, i) {
                    var o = audioCtx.createOscillator();
                    var g = audioCtx.createGain();
                    o.connect(g);
                    g.connect(audioCtx.destination);
                    o.type = 'sine';
                    o.frequency.setValueAtTime(freq, now + i * 0.15);
                    g.gain.setValueAtTime(0.12, now + i * 0.15);
                    g.gain.exponentialRampToValueAtTime(0.001, now + i * 0.15 + 0.2);
                    o.start(now + i * 0.15);
                    o.stop(now + i * 0.15 + 0.2);
                });
            } else if (type === 'win') {
                var notes2 = [523, 587, 659, 698, 784, 880, 988, 1047];
                notes2.forEach(function(freq, i) {
                    var o = audioCtx.createOscillator();
                    var g = audioCtx.createGain();
                    o.connect(g);
                    g.connect(audioCtx.destination);
                    o.type = 'sine';
                    o.frequency.setValueAtTime(freq, now + i * 0.12);
                    g.gain.setValueAtTime(0.12, now + i * 0.12);
                    g.gain.exponentialRampToValueAtTime(0.001, now + i * 0.12 + 0.15);
                    o.start(now + i * 0.12);
                    o.stop(now + i * 0.12 + 0.15);
                });
            }
        }

        function shuffle(arr) {
            for (var i = arr.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var tmp = arr[i];
                arr[i] = arr[j];
                arr[j] = tmp;
            }
            return arr;
        }

        function showEncouragement() {
            var now = Date.now();
            if (now - lastEncTime < 2000) return;
            lastEncTime = now;
            var el = document.getElementById('encourage');
            el.textContent = ENCOURAGEMENTS[Math.floor(Math.random() * ENCOURAGEMENTS.length)];
            el.classList.remove('show');
            void el.offsetWidth;
            el.classList.add('show');
        }

        function showLevelMessage(text) {
            var el = document.getElementById('level-msg');
            el.textContent = text;
            el.classList.remove('show');
            void el.offsetWidth;
            el.classList.add('show');
        }

        function addWinConfetti() {
            for (var i = 0; i < 40; i++) {
                var div = document.createElement('div');
                div.className = 'cf';
                div.style.left = Math.random() * 100 + '%';
                div.style.background = COLORS[i % COLORS.length];
                div.style.width = (Math.random() * 10 + 5) + 'px';
                div.style.height = (Math.random() * 10 + 5) + 'px';
                div.style.animationDuration = (Math.random() * 3 + 2) + 's';
                div.style.animationDelay = (Math.random() * 2) + 's';
                winScreen.appendChild(div);
            }
        }

        function createBoard() {
            board.innerHTML = '';
            var lvl = LEVELS[currentLevel];
            pairsFound = 0;
            flippedCards = [];
            lockBoard = false;

            // ×‘×—×¨ ×××•×’'×™× ××§×¨××™×™×
            var shuffledEmojis = shuffle(EMOJIS.slice());
            var selected = shuffledEmojis.slice(0, lvl.pairs);
            var cards = shuffle(selected.concat(selected));

            board.className = 'board level-' + (currentLevel + 1);

            pairsTotalEl.textContent = lvl.pairs;
            pairsFoundEl.textContent = '0';
            levelEl.textContent = (currentLevel + 1);

            cards.forEach(function(emoji) {
                var card = document.createElement('div');
                card.className = 'card';
                card.dataset.emoji = emoji;

                var back = document.createElement('div');
                back.className = 'card-face card-back';
                back.textContent = 'â“';

                var front = document.createElement('div');
                front.className = 'card-face card-front';
                front.textContent = emoji;

                card.appendChild(back);
                card.appendChild(front);

                card.addEventListener('click', onCardClick);
                card.addEventListener('touchend', function(e) { e.preventDefault(); });

                board.appendChild(card);
            });
        }

        function onCardClick(e) {
            if (lockBoard) return;
            var card = e.currentTarget;
            if (card.classList.contains('flipped') || card.classList.contains('matched')) return;

            playSound('flip');
            card.classList.add('flipped');
            flippedCards.push(card);

            if (flippedCards.length === 2) {
                lockBoard = true;
                var c1 = flippedCards[0];
                var c2 = flippedCards[1];

                if (c1.dataset.emoji === c2.dataset.emoji) {
                    // ××¦×× ×• ×–×•×’!
                    setTimeout(function() {
                        c1.classList.add('matched');
                        c2.classList.add('matched');
                        pairsFound++;
                        pairsFoundEl.textContent = pairsFound;
                        playSound('match');
                        showEncouragement();

                        flippedCards = [];
                        lockBoard = false;

                        // ×‘×“×™×§×ª ×¡×™×•× ×©×œ×‘
                        if (pairsFound >= LEVELS[currentLevel].pairs) {
                            if (currentLevel < LEVELS.length - 1) {
                                // ××¢×‘×¨ ×©×œ×‘
                                currentLevel++;
                                playSound('levelup');
                                showLevelMessage('ğŸŒŸ ×©×œ×‘ ' + (currentLevel + 1) + '! ğŸŒŸ');
                                setTimeout(createBoard, 1500);
                            } else {
                                // × ×™×¦×—×•×Ÿ!
                                playSound('win');
                                setTimeout(function() {
                                    gameArea.style.display = 'none';
                                    winScreen.style.display = 'flex';
                                    addWinConfetti();
                                }, 800);
                            }
                        }
                    }, 400);
                } else {
                    // ×œ× ××ª××™× - ×”×¤×•×š ×‘×—×–×¨×”
                    setTimeout(function() {
                        playSound('wrong');
                        c1.classList.remove('flipped');
                        c2.classList.remove('flipped');
                        flippedCards = [];
                        lockBoard = false;
                    }, 800);
                }
            }
        }

        function startGame() {
            initAudio();
            introScreen.style.display = 'none';
            winScreen.style.display = 'none';
            gameArea.style.display = 'block';
            currentLevel = 0;
            createBoard();
        }

        introScreen.onclick = startGame;
        winScreen.onclick = startGame;
    })();
    </script>
</body>
</html>
